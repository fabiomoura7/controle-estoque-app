<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Controle de Estoque</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background-color: #f5f5f5;
    }

    header {
      background-color: #333;
      color: white;
      padding: 15px;
      text-align: center;
    }

    nav {
      display: flex;
      justify-content: center;
      background-color: #4CAF50;
    }

    nav button {
      flex: 1;
      padding: 14px 16px;
      background-color: #4CAF50;
      border: none;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }

    nav button:hover {
      background-color: #45a049;
    }

    section {
      display: none;
      padding: 20px;
    }

    section.active {
      display: block;
    }

    input, select, button {
      padding: 10px;
      margin: 5px;
      font-size: 16px;
    }

    button.action {
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }

    button.action:hover {
      background-color: #45a049;
    }

    #estoque {
      background-color: white;
      padding: 15px;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .produto {
      margin-bottom: 10px;
      padding: 10px;
      border-bottom: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <header>
    <h1>Controle de Estoque</h1>
  </header>

  <nav>
    <button onclick="mostrarGuia('produtos')">Produtos</button>
    <button onclick="mostrarGuia('locais')">Locais</button>
    <button onclick="mostrarGuia('movimentacao')">Movimentação</button>
    <button onclick="mostrarGuia('estoque')">Estoque</button>
    <button onclick="mostrarGuia('relatorio')">Relatório</button>
  </nav>

  <section id="produtos" class="active">
    <h2>Cadastro de Produto</h2>
    <input type="text" id="codigoProduto" placeholder="Código do produto">
    <input type="text" id="nomeProduto" placeholder="Nome do produto">
    <input type="number" id="quantidadeInicial" placeholder="Quantidade inicial">
    <select id="localInicial"></select>
    <button class="action" onclick="cadastrarProduto()">Cadastrar Produto</button>
    <div id="listaProdutos"></div>
  </section>

  <section id="locais">
    <h2>Cadastro de Local</h2>
    <input type="text" id="nomeLocal" placeholder="Nome do local (ex: Câmara)">
    <input type="text" id="enderecoLocal" placeholder="Local (ex: 01, 02)">
    <button class="action" onclick="cadastrarLocal()">Cadastrar Local</button>
    <div id="listaLocais"></div>
  </section>

  <section id="movimentacao">
    <h2>Movimentar Produto</h2>
    <select id="selectProduto" onchange="mostrarHistoricoMovimentacao()"></select>
    <select id="selectLocalOrigem"></select>
    <select id="selectLocalDestino"></select>
    <input type="number" id="quantidade" placeholder="Quantidade">
    <button class="action" onclick="movimentarProduto()">Movimentar</button>
    <pre id="historicoProduto"></pre>
  </section>

  <section id="estoque">
    <h2>Estoque Atual</h2>
    <div id="estoqueConteudo"></div>
  </section>

  <section id="relatorio">
    <h2>Relatório de Movimentações</h2>
    <button class="action" onclick="gerarRelatorio()">Visualizar Relatório</button>
    <button class="action" onclick="gerarPDF()">Exportar PDF</button>
    <pre id="relatorioTexto"></pre>
  </section>

  <script>
    // Adicionado: Funções para editar produto/local
    function editarProduto(id) {
      const produto = produtos.find(p => p.id === id);
      const novoNome = prompt("Novo nome do produto:", produto.nome);
      const novoCodigo = prompt("Novo código do produto:", produto.codigo);
      if (novoNome && novoCodigo) {
        produto.nome = novoNome.trim();
        produto.codigo = novoCodigo.trim();
        salvarDados();
        mostrarProdutos();
        atualizarSelects();
        mostrarEstoque();
      }
    }

    function editarLocal(nome, endereco) {
      const local = locais.find(l => l.nome === nome && l.endereco === endereco);
      const novoNome = prompt("Novo nome:", local.nome);
      const novoEndereco = prompt("Novo endereço:", local.endereco);
      if (novoNome && novoEndereco) {
        local.nome = novoNome.trim();
        local.endereco = novoEndereco.trim();
        salvarDados();
        mostrarLocais();
        atualizarSelects();
      }
    }

    // Modificações nas funções mostrarProdutos e mostrarLocais para incluir botão Editar
    function mostrarProdutos() {
      const div = document.getElementById("listaProdutos");
      div.innerHTML = "<h3>Produtos Cadastrados:</h3>" + produtos.map(p =>
        `<div>${p.codigo} - ${p.nome} ` +
        `<button onclick="editarProduto('${p.id}')">Editar</button> ` +
        `<button onclick="excluirProduto('${p.id}')">Excluir</button></div>`
      ).join("");
    }

    function mostrarLocais() {
      const div = document.getElementById("listaLocais");
      div.innerHTML = "<h3>Locais Cadastrados:</h3>" + locais.map(l =>
        `<div>${l.nome} (${l.endereco}) ` +
        `<button onclick="editarLocal('${l.nome}', '${l.endereco}')">Editar</button> ` +
        `<button onclick="excluirLocal('${l.nome}', '${l.endereco}')">Excluir</button></div>`
      ).join("");
    }
  </script>
</body>
</html>
